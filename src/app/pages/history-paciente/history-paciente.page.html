<ion-content [fullscreen]="true">
  <app-card class="card-patient-history">

    <!-- Encabezado -->
    <div class="header-pages-patient-history">
      <div class="title-pages">
        <p>Historial</p>
        <p>de Pacientes</p>
      </div>
      <div class="icon-search">
        <ion-icon class="icon-search" name="search-outline" (click)="search()"></ion-icon>
      </div>
    </div>

    <!-- Tarjetas de estadísticas animadas -->
    <div class="stats-container">
      <div class="stat-card">
        <ion-icon name="people-outline"></ion-icon>
        <div class="stat-info">
          <p class="stat-number">{{ totalPacientes }}</p>
          <p class="stat-label">Pacientes<br>Registrados</p>
        </div>
      </div>

      <div class="stat-card">
        <ion-icon name="time-outline"></ion-icon>
        <div class="stat-info">
          <p class="stat-number">{{ ultimosIngresos }}</p>
          <p class="stat-label">Últimos<br>Ingresos</p>
        </div>
      </div>
    </div>

    <!-- Últimos pacientes registrados -->
    <div class="recent-patients">
      <p class="subtitle">Últimos Pacientes Registrados</p>
      <ion-list [inset]="true" mode="md" class="recent-list">
        @for (item of listPacienteFiltro().slice(0, 3); track $index) {
        <ion-item>
          <ion-avatar aria-hidden="true" slot="start">
            <img alt="" src="https://ionicframework.com/docs/img/demos/avatar.svg" />
          </ion-avatar>
          <ion-label>
            <div class="name">{{item.nombre}} {{item.apellido}}</div>
            <div class="document">{{item.dni}}</div>
          </ion-label>
        </ion-item>
        }
      </ion-list>
    </div>

    <!-- Buscador -->
    <div class="patient-search" [class.open-patient-search]="searchOpenClose()">
      <ion-searchbar class="search-input" (ionInput)="handleInput($event)" placeholder="Buscar Paciente"></ion-searchbar>
    </div>

    <!-- Lista completa de pacientes -->
    <ion-list [inset]="true" mode="md" class="item-list fade-in-list">
      @for (item of listPacienteFiltro(); track $index) {
      <ion-item-sliding>
        <ion-item>
          <ion-avatar aria-hidden="true" slot="start">
            <img alt="" src="https://ionicframework.com/docs/img/demos/avatar.svg" />
          </ion-avatar>
          <ion-label class="info-paciente">
            <div class="name">{{item.nombre}} {{item.apellido}}</div>
            <div class="document">{{item.dni}}</div>
          </ion-label>
        </ion-item>
        <ion-item-options slot="end">
          <ion-item-option color="warning" (click)="analityImagen(item)">
            <ion-icon slot="icon-only" name="camera-outline"></ion-icon>
          </ion-item-option>
          <ion-item-option color="tertiary" (click)="addUpdPaciente(item)">
            <ion-icon slot="icon-only" name="create-outline"></ion-icon>
          </ion-item-option>
          <ion-item-option color="danger" (click)="deletePaciente(item)">
            <ion-icon slot="icon-only" name="trash"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
      }
    </ion-list>

    <!-- Botón agregar paciente -->
    <ion-fab horizontal="end" vertical="bottom" slot="fixed">
      <ion-fab-button mode="md" (click)="addUpdPaciente()">
        <ion-icon name="add"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  </app-card>
</ion-content>
