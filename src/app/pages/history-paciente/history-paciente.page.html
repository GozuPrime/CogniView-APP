<ion-content [fullscreen]="true">
  <app-card class="card-patient-history">

    <!-- ðŸ”¹ Encabezado -->
    <div class="header-pages-patient-history">
      <div class="title-pages">
        <p>Historial</p>
        <p>de Pacientes</p>
      </div>
    </div>

    <!-- ðŸ”¹ Tarjetas estadÃ­sticas -->
    <div class="stats-container">
      <div class="stat-card">
        <ion-icon name="people-outline"></ion-icon>
        <div class="stat-info">
          <p class="stat-number">{{ totalPacientes }}</p>
          <p class="stat-label">Pacientes<br>Registrados</p>
        </div>
      </div>

      <div class="stat-card">
        <ion-icon name="time-outline"></ion-icon>
        <div class="stat-info">
          <p class="stat-number">{{ ultimosIngresos }}</p>
          <p class="stat-label">Ãšltimos<br>Ingresos</p>
        </div>
      </div>
    </div>

    <!-- ðŸ”¹ Ãšltimos pacientes -->
    <div class="recent-patients" *ngIf="listPacienteFiltro().length > 0">
      <p class="subtitle">Ãšltimos Pacientes Registrados</p>
      <ion-list [inset]="true" mode="md" class="recent-list">
        @for (item of listUltimosPacientes(); track $index) {
        <ion-item>
          <ion-avatar slot="start">
            <img src="https://ionicframework.com/docs/img/demos/avatar.svg" />
          </ion-avatar>
          <ion-label>
            <div class="name">{{item.nombre}} {{item.apellido}}</div>
            <div class="document">{{item.dni}}</div>
          </ion-label>
        </ion-item>
        }
      </ion-list>
    </div>

    <!-- ðŸ”¹ Buscador (debajo de los Ãºltimos pacientes) -->
    <div class="search-container fade-in">
      <ion-searchbar
        mode="ios"
        placeholder="Buscar paciente por nombre, apellido o DNI"
        debounce="300"
        (ionInput)="handleInput($event)">
      </ion-searchbar>
    </div>

    <!-- ðŸ”¹ Lista completa de pacientes -->
    <ion-list [inset]="true" mode="md" class="item-list fade-in-list" *ngIf="listPacienteFiltro().length > 0">
      @for (item of listPacienteFiltro(); track $index) {
      <ion-item-sliding>
        <ion-item>
          <ion-avatar slot="start">
            <img src="https://ionicframework.com/docs/img/demos/avatar.svg" />
          </ion-avatar>
          <ion-label class="info-paciente">
            <div class="name">{{item.nombre}} {{item.apellido}}</div>
            <div class="document">{{item.dni}}</div>
          </ion-label>
        </ion-item>
        <ion-item-options slot="end">
          <ion-item-option color="warning" (click)="analityImagen(item)">
            <ion-icon slot="icon-only" name="camera-outline"></ion-icon>
          </ion-item-option>
          <ion-item-option color="tertiary" (click)="addUpdPaciente(item)">
            <ion-icon slot="icon-only" name="create-outline"></ion-icon>
          </ion-item-option>
          <ion-item-option color="danger" (click)="deletePaciente(item)">
            <ion-icon slot="icon-only" name="trash"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
      } @empty {
      <ion-item lines="none">
        <ion-label style="text-align:center; color:#17223c;">No hay pacientes registrados.</ion-label>
      </ion-item>
      }
    </ion-list>

    <!-- ðŸ”¹ BotÃ³n agregar paciente -->
    <ion-fab horizontal="end" vertical="bottom" slot="fixed">
      <ion-fab-button mode="md" (click)="addUpdPaciente()">
        <ion-icon name="add"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  </app-card>
</ion-content>
